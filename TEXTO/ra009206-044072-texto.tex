\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[brazil]{babel}

\usepackage{float}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\newtheorem{theorem}{Teorema}[section]

\title{MO420 - TP de Planos de Cortes}
\author{RA009206 - Luís Guilherme Fernandes Pereira \\
RA044072 - Igor Ribeiro de Assis}
\date{Trabalho 3 - 1o semestre de 2009}

\begin{document}
\maketitle

\section{Introdução}

Neste trabalho prático, estudamos o problema de planos de cortes e
Branch and Cut, implementamos essa técnica no resolvedor XPress e
usamo-la para resolver o problema de \emph{minimum stabbing number}
(STAB).

\section{Formulação}

A seguinte formulação para o problema STAB foi utilizada.

\begin{align}
 min & \hspace{8pt}y\\
  s.a & \hspace{2pt}\sum_{e \in \delta (i)}{x_e} = 1 \label{grau} \\
      & \sum_{e \in E(S)}{x_e} \le (|S|-1)/2, \hspace{4pt} \forall S
  \subset P, \hspace{4pt} |S|
  \hspace{4pt} impar \label{exp} \\
      & \sum_{e \in I(r_{ij})}{x_e} \le y, \forall (i,j) \in N \times N,
    i < j \label{inter}
\end{align}

As restrições \eqref{grau} e \eqref{exp} são as restrições do problema
de emparelhamento perfeito (note que se a restrição de grau fosse do
tipo $\le$ teríamos a formulação emparelhamento máximo). As restrições
\eqref{grau} são restrições de grau e garantem que em cada vértice
exatamente uma aresta incidente nele tem o valor $x_e = 1$. As do tipo
\eqref{exp} embora não necessárias na formulação inteira do problema
do emparelhamento, ao se resolver o programa linear relaxado
correspondente elas evitam soluções com valores fracionários como na
figura \ref{fig:ciclo_impar}, e mais, são necessárias na descrição da
envoltória convexa [REFERÊNCIA DO ARTIGO AQUI].

Intuitivamente essas restrições dizem que para todo conjunto ímpar de
vértices, deve exister algum vértice ``casando'' com alguem de fora do
conjunto, observe que é importante que a $|S|$ seja ímpar caso
contrário estaríamos excluindo soluções válidas.

A variável $y$, utilizada no último grupo de restrições e na função
objetivo corresponde a um limite superior para o número de
intersecções de uma reta (das retas consideradas tendo em vista a
proposição $1$) com os segmentos do emparelhamento perfeito
encontrado, ou seja, a váriavel $y$ é um limite superior para o
$sn(M)$. Como o problema é de minimização da variável $y$, em qualquer
solução ótima no mínimo uma restrição do tipo \eqref{inter} será
satisfeita na igualdade.

\begin{figure}[H]
\centering
\includegraphics[scale=0.50]{ciclos}
\caption{Solução inválida do emparelhamento satisfazendo as restrições
  de grau}
\label{fig:ciclo_impar}
\end{figure}

Note que o número de restrições do tipo \eqref{exp} é exponencial,
portanto não é possível utilizar essa formulação com todas as
restrições é necessário um algoritmo de \emph{branch-and-cut}

Vejamos agora restrições alternativas para as do tipo \eqref{exp}, que
ao invés de somarem sobre as arestas do conjunto $S$, somam sobre as
arestas do corte cuja praia é $S$.

\begin{align}
  \sum_{e \in S}{x_e} \ge 1, \hspace{4pt}|S|\hspace{4pt} impar \label{corte}
\end{align}

Vamos mostrar que \eqref{corte} e \eqref{exp} são equivalentes.

Fixe um conjunto $S$ e seja $x^*$ uma solução do problema linear acima
que não satisfaz as restrições \eqref{exp}. Temos:

\begin{align}
  2\sum_{e \in E(S)}x_e^* > (|S| - 1)
\end{align}

Para o conjunto $S$,

\begin{align}
  \sum_{e \in \delta (S)}x_e^* = \sum_{i \in S}\sum_{e \in \delta
    (i)}x_e^* - 2\sum_{e \in E(S)}x_e^* < \sum_{i \in S}\sum_{e in
    \delta (i)}x_e^* - (|S| - 1)
\end{align}

Mas pelo fato de $x^*$ satisfazer as restrições de grau temos $\sum_{i
  \in S}\sum_{e \in \delta (i)}x_e^* = |S|$, portanto, $\sum_{e \in
  \delta (S)} < 1$, e $x^*$ não satisfaz \eqref{corte}. De maneira
análoga obtemos que se uma solução não satisfaz \eqref{corte} não
satisfaz \eqref{exp}.

Suponha agora que $x^*$ é uma solução válida para \eqref{exp}, então:

\begin{align}
  2\sum_{e \in E(S)}x_e^* \le (|S| - 1)
\end{align}

E,

\begin{align}
  \sum_{e \in \delta (S)}x_e^* = \sum_{i \in S}\sum_{e \in \delta
    (i)}x_e^* - 2\sum_{e \in E(S)}x_e^* \ge \sum_{i \in S}\sum_{e in
    \delta (i)}x_e^* - (|S| - 1)
\end{align}

Portanto, como $x^*$ satisfaz as restrições de grau, $\sum_{e \in
  \delta (S)} \ge 1$, como queríamos.

\section{Cortes Exatos}
Os cortes exatos foram implementados de forma a gerar restrições da
forma \eqref{corte}, isto é, o problema de separação resolvido era de
encontrar cortes mínimos ímpares. Para isto foi utilizada a árvore de
Gomory-Hu.

Seja $G=(V,E)$ um grafo não orientado e $c$ uma função de custo
positiva associada as arestas de $G$. Uma \emph{árvore de Gomory-Hu}
$T=(V,F)$ é uma árvore e uma função custo associada as arestas, em que
para cada aresta $e = uv$ de $T$, $\delta_G(U)$, com $U$ o conjunto de
vértices de uma das componentes de $T-e$, é um u-v-corte mínimo, e o
valor do corte é o custo da aresta $e$ em $T$. Além disso, dado dois
vértices quaisquer $u$ e $v$ de $G$ o valor do u-v-corte mínimo é o
custo da menor aresta no caminho de $u$ à $v$ em $T$.

Na figura \ref{fig:gomoryhu} (baseada em figura de \cite{bondymurty})
temos um grafo $G$ e a árvore de Gomory-Hu correspondente.

\begin{figure}[H]
\centering
\includegraphics[scale=0.40]{gomoryhu.png}
\caption{Grafo e árvore de Gomory-Hu correspondente}
\label{fig:gomoryhu}
\end{figure}

No grafo temos marcado o corte separando os vértices $w$ e $v$ e na
árvore, a aresta correspondente ao corte.

A partir da árvore de Gomory-Hu e do teorema (T1) que garante que um dos
cortes fundamentais determinados pela árvore é um corte ímpar mínimo,
temos um algoritmo para realizar o corte exato:

\begin{enumerate}
  \item Para cada aresta $e$ de $T$ com $c(e) < 1$
  \item Conte o número de vértices de uma das componentes de $T-e$
  \item Se ímpar, desigualdade violada.
\end{enumerate}

Note que so precisa contar os vértices de uma das componentes, pois
como para ter emparelhamento perfeito o grafo precisa ter um número
par de vértices, a paridade das componentes é a mesma.

Se pelo algoritmo acima nenhum corte for encontrado, então (pelo
teorema T1) não há restrição do tipo \eqref{corte} violada.

Analisando a complexidade do algoritmo temos que está é: $O(f(|V|,
|E|) + |V|)$ onde $f(|V|,|E|)$ é a complexidade de se encontrar a árvore
de Gomory-Hu, o que pode ser feita por exemplo em $O(|V|*|V|^2\sqrt(|E|))$ com
$|V|$ aplicações do algoritmo de preflow para encontrar o corte mínimo
\cite{schrijver2003cop}.

\section{Heurísticas}

Implementamos duas estratégias heurísticas, sendo uma para separação de
cortes e outra para encontrar limitantes primais. 

\subsection{Heurística de Separação de Cortes}

Baseado na restrição \eqref{exp}, podemos encontrar desigualdades
violadas de maneira simples, e executamos o seguinte algoritmo: para
toda aresta $e$, ligando os vértices $i$ e $j$, de valor relaxado \( 0,5
< x_e < 1 \), verificamos se existem vértices $k$ tais que \( x_{ij} +
x_{ik} + x_{jk} > 1 \). Caso encontremos esses ciclos, adicionamos a
seguinte desigualdade válida para cada um deles: 

\begin{equation}
 x_{ij} + x_{ik} + x_{jk} \leq 1
\end{equation}

Como é simples constatar, essa desigualdade corresponde à restrição
\eqref{exp} para um conjunto $S$ de tamanho $3$. 

Para cada aresta, fazemos uma busca nos vértices. Logo, a complexidade
da separação heurística é $O(|V||E|)$

\subsection{Heurística Primal}

Bons limitantes primais, como será mostrado na seção de resultados,
ajudam sobremaneira na resolução de problemas difíceis, principalmente
quando se usam estratégias de \emph{branching}.

Dada uma solução da relaxação linear $x^*$, podemos encontrar um
emparelhamento perfeito da seguinte forma (e, portanto, uma solução
viável para o STAB): para cada aresta $x^*_e$, arrendondamos o seu valor
para $0$ ou $1$, de forma que a restrição \eqref{grau} seja satisfeita
para todo vértice. 

Inicialmente testamos o seguinte algoritmo: para cada vértice $i$ não
emparelhado, encontre o vértice $j$ não emparelhado cuja aresta $x_ij$
tem o maior valor relaxado. Marque $i$ e $j$ como emparelhados, e
arredonde $x_ij$ para 1. $\forall k \notin {i,j}$, $x_ik$ e $x_jk$ são
marcados como zero. Essa heurística primal raramente melhorava a
solução e não contribuiu para a redução do número de nós pesquisados
pelos algoritmos de \emph{branching}. Essa heurística tem complexidade
$O(|V||E|)$ 

Implementamos um algoritmo muito semelhante, mas que diferia na ordem de
busca das arestas a serem arredondadas para valores integrais, e
obtivemos resultados incrivelmente superiores. Inicialmente, ordenamos
as arestas decrescentemente por valor relaxado. Percorrendo-as nessa
ordem, caso elas ligassem dois vértices $i$ e $j$ ainda não emparelhados,
arredondava-se seu valor para $1$, $i$ e $j$ eram marcados como
emparelhados. Caso contrário, seu valor era marcado como $0$. 

Nesse algoritmo ordenamos as arestas e depois percorremo-nas executando
operações triviais. A ordenação domina a computação dessa heurística e,
portanto, sua complexidade é dada por $O(|E| log (|E|))$.

\bibliographystyle{alpha}
\bibliography{ra009206-044072-texto.bib}

\end{document}
